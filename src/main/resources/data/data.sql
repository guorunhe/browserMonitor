
-- 创建数据库
CREATE DATABASE service DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 创建表
use service;

-- 创建 用户表
CREATE TABLE sys_user (
  id INT NOT NULL AUTO_INCREMENT COMMENT '用户id',
  account VARCHAR(32) NOT NULL COMMENT '用户账号',
  username VARCHAR(32) NOT NULL COMMENT '用户姓名',
  password VARCHAR(64) NOT NULL COMMENT '用户密码',
  email VARCHAR(32) NOT NULL COMMENT '用户邮箱',
  telephone VARCHAR(16) NOT NULL COMMENT '用户联系方式',
  rid INT NOT NULL COMMENT '角色id',
  salt VARCHAR(64) NOT NULL COMMENT '随机盐',
  PRIMARY KEY (id)
) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;

-- 创建 角色表
CREATE TABLE sys_role (
  id INT NOT NULL AUTO_INCREMENT COMMENT '角色id',
  name VARCHAR(32) NOT NULL COMMENT '角色名',
  description VARCHAR(128) COMMENT '描述',
  PRIMARY KEY (id)
) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;

-- 创建 用户—角色 关联表
# CREATE TABLE sys_user_role (
#   id INT NOT NULL AUTO_INCREMENT COMMENT '表id',
#   uid INT NOT NULL COMMENT '用户id',
#   rid INT NOT NULL COMMENT '角色id',
#   PRIMARY KEY (id)
# ) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;

-- 创建 权限表
CREATE TABLE sys_permission (
  id INT NOT NULL AUTO_INCREMENT COMMENT '权限id',
  name VARCHAR(32) NOT NULL COMMENT '权限名',
  url VARCHAR(128) NOT NULL COMMENT '资源请求连接',
  description VARCHAR(128) COMMENT '描述',
  pid int COMMENT '父id',
  PRIMARY KEY (id)
) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;

-- 创建 角色-权限 关联表
CREATE TABLE sys_role_permission (
  id INT NOT NULL AUTO_INCREMENT COMMENT '表id',
  rid INT NOT NULL COMMENT '用户id',
  pid INT NOT NULL COMMENT '角色id',
  PRIMARY KEY (id)
) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;

-- 创建 主要业务表
CREATE TABLE sys_business (
  id INT NOT NULL AUTO_INCREMENT COMMENT '业务id',
  uid INT NOT NULL COMMENT '用户id',
  fid INT NOT NULL COMMENT '故障id',
  rid INT NOT NULL COMMENT '区域id',
  description VARCHAR(255) NOT NULL COMMENT '用户故障描述',
  once INT NOT NULL DEFAULT 0 COMMENT '用户电话确认状态位',
  mid INT NOT NULL DEFAULT 0 COMMENT '维修人员id',
  receipt VARCHAR(255) NOT NULL DEFAULT '' COMMENT '维修人员故障描述',
  twice INT NOT NULL DEFAULT 0 COMMENT '最终结果确认',
  PRIMARY KEY (id)
) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;

-- 创建 区域信息表
CREATE TABLE sys_region (
  id INT NOT NULL AUTO_INCREMENT COMMENT '区域id',
  name VARCHAR(255) NOT NULL COMMENT '区域地点',
  description VARCHAR(128) COMMENT '区域描述',
  PRIMARY KEY (id)
) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;

-- 创建 故障分类表
CREATE TABLE sys_fault (
  id INT NOT NULL AUTO_INCREMENT COMMENT '故障id',
  name VARCHAR(255) NOT NULL COMMENT '故障名',
  description VARCHAR(128) COMMENT '故障描述',
  PRIMARY KEY (id)
) ENGINE=InnoDB AUTO_INCREMENT = 6586 DEFAULT CHARSET=utf8mb4;